<h1 class="text-center mt-5">Productos</h1>

<div id="productContainer" class="">



</div>


<script>
  // Función para cargar productos con paginación
  // get product id from url /products/:id
  const urlParts = window.location.pathname.split('/');
  const productId = urlParts[urlParts.length - 1];
  loadProductID(productId);

  // Cargar y mostrar los productos al cargar la página
  async function loadProductID(id) {
    try {
      const response = await fetch(`/api/products/${id}`);
      if (!response.ok) {
        throw new Error('Error al obtener el producto');
      }
      const product = await response.json();
      renderProduct(product);
    } catch (error) {
      console.error('Error al cargar el producto:', error);
      const container = document.getElementById('productContainer');
      container.innerHTML = '<p class="fs-4 text-center">Error al cargar el producto.</p>';
    }
  }



  // Renderizar los productos en el contenedor
  function renderProduct(product) {
    /*
    {
      "_id": "68c3828c912bc80ffdc2cb0a",
      "title": "Nike",
      "description": "Nike Dunk Low Retro",
      "code": "code0007",
      "price": 40500,
      "status": true,
      "stock": 17,
      "category": "calzado",
      "thumbnails": [
          "https://example.com/images/nike_7.jpg"
      ],
      "__v": 0
    } 
    */

    const container = document.getElementById('productContainer');
    
    if (!product) {
      container.innerHTML = '<p class="fs-4 text-center">No hay productos disponibles.</p>';
      return;
    }

    container.innerHTML = '';
    const productsContainer = document.getElementById('productContainer');
    productsContainer.className = '';
    const productCard = document.createElement('div');
    productCard.innerHTML = `
          <div class="container my-5">
            <div class="row">
              <div class="col-md-6">
                <div
                  class="card card-image-container position-relative overflow-hidden"
                >
                  <img
                    class="card-img-top main-image"
                    alt="${product.title}"
                    src="${product.thumbnails[0]}"
                  />
                </div>
              </div>
              <div class="col-md-6 mt-5 mt-md-0 d-flex flex-column gap-2">
                <h5>${product.title}</h5>
                <h3>${product.description}</h3>
                <div class="text-muted">
                  <ul class="list-unstyled">
                    <li><span class="text-dark-emphasis fw-bold">$${product.price}</span></li>
                    <li>
                      6 cuotas de: <span class="text-dark-emphasis">$${(product.price / 6).toFixed(2)}</span>
                    </li>
                    <li>
                      <span class="text-dark-emphasis fw-bold">$${(product.price * 0.85).toFixed(2)}</span>
                      <small class="text-muted">con Transferencia</small>
                    </li>
                  </ul>
                </div>
                <p class="d-none"></p>
                <div class="d-flex flex-column gap-3 p-3 border rounded">
                  <div
                    class="d-flex justify-content-center align-items-center gap-3 flex-wrap"
                  >
                    <h5 class="text-center m-0 p-0 d-none">Cantidad</h5>
                    <div
                      class="btn-group d-flex justify-content-center align-items-center d-none"
                    >
                      <button class="btn btn-outline-secondary px-3 py-2 fs-5">
                        <i class="bi bi-dash"></i>
                      </button>
                      <div
                        class="px-4 py-2 border border-secondary border-end-0 border-start-0 bg-white fs-5 text-center"
                        style="min-width: 60px"
                      >
                        1
                      </div>
                      <button class="btn btn-outline-secondary px-3 py-2 fs-5">
                        <i class="bi bi-plus"></i>
                      </button>
                    </div>
                    <small class="m-0 p-0 text-muted text-center">${product.stock} disponibles</small>
                  </div>
                  <button class="btn btn-warning py-2" onclick="addToCart('${product._id}')" aria-label="Agregar al carrito">Agregar al carrito</button>
                </div>
                <div class="card" style="font-size: 0.8em">
                  <ul class="list-unstyled p-3">
                    <li>Precio Exclusivo Online</li>
                    <li>El precio puede variar en nuestras tiendas físicas:</li>
                    <li>
                      - Tendrás atención personalizada por profesionales especializado
                    </li>
                    <li>
                      - Ganas la oportunidad de ver, tocar y probar en físico multitud
                      de productos
                    </li>
                  </ul>
                </div>
              </div>
            </div>
          </div>

    `;
    productsContainer.appendChild(productCard);
  }

  

</script>
